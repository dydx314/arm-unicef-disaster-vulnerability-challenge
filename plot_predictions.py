import os
import argparse
import pandas as pd
import json

from utils import plot_results

IMAGE_DIR = "../../Downloads/Images"

#EXAMPLE_IMG_ID = "id_av0kj02v1wvd"
EXAMPLE_IMG_ID = "id_g90x61v9o3g8"
EXAMPLE_TEXT = "grass-roof houses."


def main():
    parser = argparse.ArgumentParser(description='plots img with ground truth bbox')
    parser.add_argument('image_id')           # positional argument
    parser.add_argument('--text', action='store')
    parser.add_argument('--result_name', action='store')
    parser.add_argument('--save_path', action='store')

    args = parser.parse_args()
    image_id = args.image_id
    text = args.text
    result_json = f"results/grounding_dino/{args.result_name}.json"
    save_path = args.save_path


    result_dict = None
    with open(result_json, "r") as f:
        results = json.load(f)
        result_dict = results[image_id]

    img_path = f"{IMAGE_DIR}/{image_id}.tif"
    plot_results(img_path,
        text,
        result_dict["scores"],
        result_dict["labels"],
        result_dict["boxes"],
        show_plot=True
    )


if __name__ == "__main__":
    main()
