from typing import Tuple
import pandas as pd
import random
import os


def split_train_val(df: pd.DataFrame) -> Tuple[pd.DataFrame, pd.DataFrame]:
    unique_images = df["image_id"].unique()
    random.Random(42).shuffle(unique_images)

    val_size = int(len(unique_images) * 0.2)
    train_images = unique_images[: (len(unique_images) - val_size)]
    val_images = unique_images[-val_size:]
    train_df = df[df["image_id"].isin(train_images)]
    val_df = df[df["image_id"].isin(val_images)]
    return train_df, val_df

def print_files_in_path(path):
    try:
        # List all files and directories in the specified path
        with os.scandir(path) as entries:
            for entry in entries:
                # Check if the entry is a file
                if entry.is_file():
                    print(entry.name)
    except FileNotFoundError:
        print(f"The path {path} does not exist")
    except PermissionError:
        print(f"Permission denied for the path {path}")
    except Exception as e:
        print(f"An error occurred: {e}")
