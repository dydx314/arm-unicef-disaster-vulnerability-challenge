from typing import Tuple
import pandas as pd
import random

random.seed(42)


def split_train_val(df: pd.DataFrame) -> Tuple[pd.DataFrame, pd.DataFrame]:
    unique_images = df["image_id"].unique()
    random.shuffle(unique_images)

    val_size = int(len(unique_images) * 0.2)
    train_images = unique_images[: (len(unique_images) - val_size)]
    val_images = unique_images[-val_size:]
    train_df = df[df["image_id"].isin(train_images)]
    val_df = df[df["image_id"].isin(val_images)]
    return train_df, val_df
