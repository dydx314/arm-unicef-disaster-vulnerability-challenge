import os
import random
from typing import Tuple

import pandas as pd
from sklearn.model_selection import train_test_split


def split_train_val(df: pd.DataFrame) -> Tuple[pd.DataFrame, pd.DataFrame]:
    unique_images = df["image_id"].unique()
    train_images, val_images = train_test_split(
        unique_images, test_size=0.2, random_state=42
    )
    train_df = df[df["image_id"].isin(train_images)]
    val_df = df[df["image_id"].isin(val_images)]
    return train_df, val_df


def print_files_in_path(path):
    try:
        # List all files and directories in the specified path
        with os.scandir(path) as entries:
            for entry in entries:
                # Check if the entry is a file
                if entry.is_file():
                    print(entry.name)
    except FileNotFoundError:
        print(f"The path {path} does not exist")
    except PermissionError:
        print(f"Permission denied for the path {path}")
    except Exception as e:
        print(f"An error occurred: {e}")


def gen_data_by_class(df):
    df_by_class = df.groupby(["image_id", "category_id"]).count()
    return df_by_class
